# Additional Tasks

## 5.1 Actuator and Sensor Hardware Selection

### Actuators:
- **Thrusters:**  
  The thrusters produce a force \( F_i \) in the direction of their orientation. The total force \( \mathbf{F} \) and torque \( \mathbf{\tau} \) acting on the Chaser can be expressed as:
  \[
  \mathbf{F} = \sum_{i=1}^n F_i \mathbf{\hat{d}}_i
  \]
  \[
  \mathbf{\tau} = \sum_{i=1}^n (\mathbf{r}_i \times F_i \mathbf{\hat{d}}_i)
  \]
  where:
  - \( \mathbf{\hat{d}}_i \) is the unit vector in the direction of the \( i \)-th thruster,
  - \( \mathbf{r}_i \) is the position vector of the \( i \)-th thruster relative to the Chaser's center of mass,
  - \( n \) is the number of thrusters.

- **Reaction Wheels:**  
  The angular momentum \( \mathbf{H} \) of a reaction wheel is given by:
  \[
  \mathbf{H} = I_w \mathbf{\omega}_w
  \]
  where:
  - \( I_w \) is the moment of inertia of the wheel,
  - \( \mathbf{\omega}_w \) is the angular velocity of the wheel.

  The torque \( \mathbf{\tau} \) generated by the reaction wheel is:
  \[
  \mathbf{\tau} = \frac{d\mathbf{H}}{dt} = I_w \dot{\mathbf{\omega}}_w
  \]

### Sensors:
- **IMU:**  
  The IMU measures linear acceleration \( \mathbf{a} \) and angular velocity \( \mathbf{\omega} \). The measured acceleration \( \mathbf{a}_m \) is:
  \[
  \mathbf{a}_m = \mathbf{a} + \mathbf{g} + \mathbf{\eta}_a
  \]
  where:
  - \( \mathbf{g} \) is the gravitational acceleration,
  - \( \mathbf{\eta}_a \) is the accelerometer noise.

  The measured angular velocity \( \mathbf{\omega}_m \) is:
  \[
  \mathbf{\omega}_m = \mathbf{\omega} + \mathbf{\eta}_\omega
  \]
  where \( \mathbf{\eta}_\omega \) is the gyroscope noise.

- **LIDAR/Vision Sensors:**  
  These sensors measure the relative position \( \mathbf{r}_{rel} \) and orientation \( \mathbf{q}_{rel} \) between the Chaser and Target. The measurement model is:
  \[
  \mathbf{r}_{rel, m} = \mathbf{r}_{rel} + \mathbf{\eta}_r
  \]
  \[
  \mathbf{q}_{rel, m} = \mathbf{q}_{rel} \otimes \mathbf{\eta}_q
  \]
  where:
  - \( \mathbf{\eta}_r \) is the position measurement noise,
  - \( \mathbf{\eta}_q \) is the orientation measurement noise (quaternion noise),
  - \( \otimes \) denotes quaternion multiplication.

---

## 5.2 Optimal Thruster Configuration

### Thruster Force and Torque Calculation:
For a cross configuration with four thrusters, the force and torque equations can be written in matrix form:
\[
\begin{bmatrix}
F_x \\
F_y \\
\tau_z
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & -1 & 0 \\
0 & 1 & 0 & -1 \\
r & r & r & r
\end{bmatrix}
\begin{bmatrix}
F_1 \\
F_2 \\
F_3 \\
F_4
\end{bmatrix}
\]
where:
- \( F_x, F_y \) are the forces in the x and y directions,
- \( \tau_z \) is the torque about the z-axis,
- \( r \) is the distance from the center of mass to each thruster.

### Redundancy:
If one thruster fails, the remaining thrusters can still provide control authority. For example, if \( F_1 \) fails, the system can solve for \( F_2, F_3, F_4 \) to achieve the desired \( F_x, F_y, \tau_z \).

---

## 5.3 Optimal Strategy for State Estimation

### Kalman Filter:
The Kalman filter consists of two steps:
1. **Prediction Step:**
   \[
   \mathbf{\hat{x}}_{k|k-1} = \mathbf{A} \mathbf{\hat{x}}_{k-1|k-1} + \mathbf{B} \mathbf{u}_k
   \]
   \[
   \mathbf{P}_{k|k-1} = \mathbf{A} \mathbf{P}_{k-1|k-1} \mathbf{A}^T + \mathbf{Q}
   \]
   where:
   - \( \mathbf{\hat{x}}_{k|k-1} \) is the predicted state,
   - \( \mathbf{P}_{k|k-1} \) is the predicted covariance,
   - \( \mathbf{A} \) is the state transition matrix,
   - \( \mathbf{B} \) is the control input matrix,
   - \( \mathbf{Q} \) is the process noise covariance.

2. **Update Step:**
   \[
   \mathbf{K}_k = \mathbf{P}_{k|k-1} \mathbf{H}^T (\mathbf{H} \mathbf{P}_{k|k-1} \mathbf{H}^T + \mathbf{R})^{-1}
   \]
   \[
   \mathbf{\hat{x}}_{k|k} = \mathbf{\hat{x}}_{k|k-1} + \mathbf{K}_k (\mathbf{z}_k - \mathbf{H} \mathbf{\hat{x}}_{k|k-1})
   \]
   \[
   \mathbf{P}_{k|k} = (\mathbf{I} - \mathbf{K}_k \mathbf{H}) \mathbf{P}_{k|k-1}
   \]
   where:
   - \( \mathbf{K}_k \) is the Kalman gain,
   - \( \mathbf{H} \) is the measurement matrix,
   - \( \mathbf{R} \) is the measurement noise covariance,
   - \( \mathbf{z}_k \) is the measurement.

### Extended Kalman Filter (EKF):
For nonlinear systems, the EKF linearizes the system around the current state estimate:
\[
\mathbf{A}_k = \frac{\partial f(\mathbf{x}, \mathbf{u})}{\partial \mathbf{x}} \bigg|_{\mathbf{\hat{x}}_{k-1|k-1}, \mathbf{u}_k}
\]
\[
\mathbf{H}_k = \frac{\partial h(\mathbf{x})}{\partial \mathbf{x}} \bigg|_{\mathbf{\hat{x}}_{k|k-1}}
\]
where \( f(\mathbf{x}, \mathbf{u}) \) is the system dynamics and \( h(\mathbf{x}) \) is the measurement model.

---

## 5.4 Practical Implementation Challenges

### Actuator Limitations:
- **Actuation Delays:**  
  The control input \( \mathbf{u}(t) \) is delayed by \( \tau \):
  \[
  \mathbf{u}(t) = \mathbf{u}_{desired}(t - \tau)
  \]
  This can be compensated for using a Smith predictor or predictive control techniques.

- **Maximum Thrust:**  
  The thrusters have a saturation limit \( F_{max} \):
  \[
  |F_i| \leq F_{max}
  \]
  The control algorithm must ensure that the commanded thrust does not exceed this limit.

### Sensor Noise and Calibration:
- **Noise Reduction:**  
  Sensor noise \( \mathbf{\eta} \) is typically modeled as Gaussian white noise with zero mean and covariance \( \mathbf{R} \):
  \[
  \mathbf{\eta} \sim \mathcal{N}(0, \mathbf{R})
  \]
  The Kalman filter optimally reduces the effect of this noise.

- **Calibration:**  
  Sensor calibration involves estimating the bias \( \mathbf{b} \) and scale factor \( \mathbf{S} \):
  \[
  \mathbf{z}_{calibrated} = \mathbf{S} (\mathbf{z}_{raw} - \mathbf{b})
  \]

---

## 5.5 Edge Case Analysis for Thruster Failure

### Single Thruster Failure:
If the \( i \)-th thruster fails, the remaining thrusters must compensate for the lost force and torque. The control allocation problem becomes:
\[
\begin{bmatrix}
F_x \\
F_y \\
\tau_z
\end{bmatrix}
=
\mathbf{T}_{-i} \mathbf{F}_{-i}
\]
where \( \mathbf{T}_{-i} \) is the thruster configuration matrix excluding the \( i \)-th thruster, and \( \mathbf{F}_{-i} \) is the vector of remaining thruster forces.

### Multiple Thruster Failures:
If multiple thrusters fail, the system may become underactuated. The controllability matrix \( \mathbf{C} \) must be checked:
\[
\mathbf{C} = [\mathbf{B}, \mathbf{A} \mathbf{B}, \mathbf{A}^2 \mathbf{B}, \dots]
\]
If \( \text{rank}(\mathbf{C}) < n \), the system is uncontrollable, and the docking maneuver must be aborted.

### Fault Detection and Diagnosis:
A residual \( \mathbf{r} \) can be computed as:
\[
\mathbf{r} = \mathbf{z} - \mathbf{H} \mathbf{\hat{x}}
\]
If \( \|\mathbf{r}\| \) exceeds a threshold, a fault is detected. The fault can be diagnosed using statistical methods (e.g., Chi-square test).

---

### Conclusion
By incorporating detailed mathematical models and analysis, the Chaser Cart system can achieve robust and reliable docking operations. The use of optimal control, state estimation, and fault-tolerant strategies ensures that the system can handle practical challenges and edge cases effectively.